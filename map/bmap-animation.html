<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="text/javascript"
        src="https://api.map.baidu.com/api?v=1.0&&type=webgl&ak=uqCJpH7b1riMwSMg3URbiHuKbrfxQeFi">
        </script>
    <style>
        /* html,
        body,
        #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        } */

        /* 百度地图logo */
        /* .anchorBL,
        .BMap_cpyCtrl {
            display: none;
        } */



        body,
        html,
        #allmap {
            width: 100%;
            height: 100%;
            overflow: hidden;
            margin: 0;
            font-family: "微软雅黑";
        }

        #allmap {
            position: relative;
        }

        #tools {
            position: absolute;
            left: 0;
            top: 0;
            z-index: 1000;
        }
    </style>
</head>

<body>
    <!-- <div id="map"></div> -->
    <!-- <script>
        // console.log(window.BMapGL)
        var map = new BMapGL.Map('map')
        // 北京的经纬度
        var point = new BMapGL.Point(116.404, 39.915);
        map.centerAndZoom(point,20)
        // 打开滚轮
        map.enableScrollWheelZoom(true)
        map.setTilt(50)
        map.setHeading(100)
        var keyFrames=[{
            center: new BMapGL.Point(116.404, 39.915), 
            zoom: 21,
            heading:0,
            tilt: 50,
            percentage: 0
        }, {
            // 地图中心点
                center: new BMapGL.Point(116.404, 39.915),
                // 地图缩放级别
                zoom: 21,
                // 地图旋转角度
                heading: 100,
                // 地图倾斜角度
                tilt: 50,
                // 当前关键帧处于动画百分比0~1
                percentage: 0.5
            }, {
                center: new BMapGL.Point(116.404, 39.915),
                zoom: 21,
                heading: 200,
                tilt: 50,
                percentage: 1
            }]
        var opts={
            // 开始延迟时间 ms
            delay: 1000,
            // 动画持续时间 ms
            duration: 3000,
            // 循环次数
            interation: 1
        }
        var animation=new BMapGL.ViewAnimation(keyFrames,opts)
        map.startViewAnimation(animation)
    </script> -->
    <div id="allmap"></div>
    <div id="tools">
        <button id="start">播放动画</button>
        <button id="end">停止播放</button>
    </div>
    <script type="text/javascript">
        var bmap = new BMapGL.Map("allmap");                          // 创建Map实例
        bmap.centerAndZoom(new BMapGL.Point(116.414, 39.915), 20);    // 初始化地图，设置中心点坐标和地图级别
        bmap.enableScrollWheelZoom(true);                             // 开启鼠标滚轮缩放
        bmap.setTilt(20);                              // 设置地图初始倾斜角度
        var keyFrames = [
            {
                center: new BMapGL.Point(116.307092, 40.054922),
                zoom: 20,
                tilt: 50,
                heading: 0,
                percentage: 0
            },
            {
                center: new BMapGL.Point(116.307631, 40.055391),
                zoom: 21,
                tilt: 70,
                heading: 0,
                percentage: 0.1
            },
            {
                center: new BMapGL.Point(116.306858, 40.057887),
                zoom: 21,
                tilt: 70,
                heading: 0,
                percentage: 0.25
            },
            {
                center: new BMapGL.Point(116.306858, 40.057887),
                zoom: 21,
                tilt: 70,
                heading: -90,
                percentage: 0.35
            },
            {
                center: new BMapGL.Point(116.307904, 40.058118),
                zoom: 21,
                tilt: 70,
                heading: -90,
                percentage: 0.45
            },
            {
                center: new BMapGL.Point(116.307904, 40.058118),
                zoom: 21,
                tilt: 70,
                heading: -180,
                percentage: 0.55
            },
            {
                center: new BMapGL.Point(116.308902, 40.055954),
                zoom: 21,
                tilt: 70,
                heading: -180,
                percentage: 0.75
            },
            {
                center: new BMapGL.Point(116.308902, 40.055954),
                zoom: 21,
                tilt: 70,
                heading: -270,
                percentage: 0.85
            },
            {
                center: new BMapGL.Point(116.307779, 40.055754),
                zoom: 21,
                tilt: 70,
                heading: -360,
                percentage: 0.95
            },
            {
                center: new BMapGL.Point(116.307092, 40.054922),
                zoom: 20,
                tilt: 50,
                heading: -360,
                percentage: 1
            },
        ];
        var opts = {
            duration: 10000,     // 设置每次迭代动画持续时间
            delay: 3000,         // 设置动画延迟开始时间
            interation: 'INFINITE'        // 设置动画迭代次数
        };
        var animation = new BMapGL.ViewAnimation(keyFrames, opts);        // 初始化动画实例
        animation.addEventListener('animationstart', function (e) {        // 监听动画开始事件
            console.log('start');
        });
        animation.addEventListener('animationiterations', function (e) {   // 监听动画迭代事件
            console.log('onanimationiterations');
        });
        animation.addEventListener('animationend', function (e) {        // 监听动画结束事件
            console.log('end');
        });
        animation.addEventListener('animationcancel', function (e) {       // 监听动画中途被终止事件
            console.log('cancel');
        });
        document.getElementById('start').addEventListener('click', function () {
            bmap.startViewAnimation(animation);         // 开始播放动画
        });
        document.getElementById('end').addEventListener('click', function () {
            bmap.cancelViewAnimation(animation);         // 强制停止动画
        });
    </script>
</body>

</html>